MYAGENT-MIB DEFINITIONS ::= BEGIN

IMPORTS
    MODULE-IDENTITY, OBJECT-TYPE, Integer32, enterprises, NOTIFICATION-TYPE
        FROM SNMPv2-SMI
    DisplayString
        FROM SNMPv2-TC
    MODULE-COMPLIANCE, OBJECT-GROUP, NOTIFICATION-GROUP
        FROM SNMPv2-CONF;

myAgentMib MODULE-IDENTITY
    LAST-UPDATED "20251106Z"
    ORGANIZATION "Zaragoza Network Management Research Group"
    CONTACT-INFO
        "Email: alesanco@unizar.es"
    DESCRIPTION
        "Mini SNMP Agent MIB: monitoriza uso de CPU y notifica si supera un umbral."
    ::= { enterprises 28308 1 }

-- Raíces del módulo
cpuObjects       OBJECT IDENTIFIER ::= { myAgentMib 1 }
cpuNotifications OBJECT IDENTIFIER ::= { myAgentMib 2 }
cpuConformance   OBJECT IDENTIFIER ::= { myAgentMib 3 }

-- =========================
--      OBJECT-TYPEs
-- =========================

manager OBJECT-TYPE
    SYNTAX      DisplayString (SIZE (1..255))
    MAX-ACCESS  read-write
    STATUS      current
    DESCRIPTION "Identificador del manager que recibe las notificaciones."
    ::= { cpuObjects 1 }

managerEmail OBJECT-TYPE
    SYNTAX      DisplayString (SIZE (3..255))
    MAX-ACCESS  read-write
    STATUS      current
    DESCRIPTION "Email de contacto del manager."
    ::= { cpuObjects 2 }

cpuUsage OBJECT-TYPE
    SYNTAX      Integer32 (0..100)
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION "Uso actual de CPU en porcentaje."
    ::= { cpuObjects 3 }

cpuThreshold OBJECT-TYPE
    SYNTAX      Integer32 (0..100)
    MAX-ACCESS  read-write
    STATUS      current
    DESCRIPTION "Umbral (%) a partir del cual se dispara la notificación."
    ::= { cpuObjects 4 }

-- =========================
--   NOTIFICATION-TYPE
-- =========================

cpuOverThresholdNotification NOTIFICATION-TYPE
    OBJECTS { cpuUsage, cpuThreshold, manager, managerEmail }
    STATUS  current
    DESCRIPTION
        "Se emite cuando cpuUsage supera cpuThreshold."
    ::= { cpuNotifications 1 }

-- =========================
--   CONFORMANCE (opcional)
-- =========================

cpuObjectsGroup OBJECT-GROUP
    OBJECTS { manager, managerEmail, cpuUsage, cpuThreshold }
    STATUS  current
    DESCRIPTION "Grupo de objetos del mini agente."
    ::= { cpuConformance 1 }

cpuNotificationsGroup NOTIFICATION-GROUP
    NOTIFICATIONS { cpuOverThresholdNotification }
    STATUS  current
    DESCRIPTION "Grupo de notificaciones del mini agente."
    ::= { cpuConformance 2 }

cpuCompliance MODULE-COMPLIANCE
    STATUS  current
    DESCRIPTION "Cumplimiento mínimo del mini agente."
    MODULE
        MANDATORY-GROUPS { cpuObjectsGroup, cpuNotificationsGroup }
    ::= { cpuConformance 3 }

END
